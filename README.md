# 얼마닥 (EolmaDoc) - Backend

## 프로젝트 개요
건강보험심사평가원의 공공데이터를 기반으로 비급여 진료비 정보를 수집 및 가공하고, 생성형 AI(Gemini)를 연동하여 사용자 맞춤형 분석 리포트를 제공하는 RESTful API 서버입니다.

## 기술 스택
- 언어: Java 21
- 프레임워크: Spring Boot 3.5.7
- 데이터베이스: PostgreSQL 42.6.0
- ORM: Spring Data JPA (Hibernate)
- AI: Google Gemini 2.5 Flash (google-genai 1.0.0)
- 인프라: AWS EC2

## 핵심 기능
- 비급여 진료비 데이터 분석: 심평원 API를 통해 수집된 진료비 항목별 가격 정보를 필터링 및 가공하여 제공합니다.
- AI 맞춤형 리포트: 사용자가 선택한 진료명과 지역을 바탕으로 최저가, 평균가 분석 및 합리적 선택 가이드를 생성합니다.
- 검색 기록 관리: 사용자의 과거 검색 내역과 AI 분석 결과를 저장하여 재조회 기능을 제공합니다.

## 데이터베이스 설계 (ERD)
- Hospital: 의료기관 기본 정보 및 위치 데이터 관리
- Clinic: 비급여 진료 항목 정보
- Sido / Sigungu: 행정구역 기반의 지역 검색 최적화
- SearchLog: 사용자별 검색 요청 이력 저장
- AiComment: SearchLog와 연계된 AI의 분석 결과 정형화 저장

## 주요 기술적 성과
### 1. 대용량 데이터 처리 성능 최적화
- 문제: 수만 건의 공공데이터를 INSERT 할 때 단일 쿼리 방식으로 인한 성능 병목 발생
- 해결: JDBC Batch Update를 활용하여 쿼리를 벌크로 처리하도록 구현했습니다.
- 설정: application.yaml에서 batch_size를 1000으로 설정하고, order_inserts 및 order_updates를 활성화하여 쓰기 성능을 극대화했습니다.

### 2. AI 응답 정형화 및 통합
- 문제: 생성형 AI의 비정형 응답을 프론트엔드에 전달하거나 DB에 저장하기 어려운 문제
- 해결: 시스템 프롬프트 설계를 통해 AI가 JSON 형식으로만 응답하도록 강제하여 데이터 파싱의 안정성을 확보했습니다.

### 3. 모듈화 및 유지보수성 향상
- 멘토 피드백을 반영하여 데이터 수집(Collector)과 데이터 가공(Processor) 로직을 독립적인 모듈로 분리했습니다.
- 이를 통해 공공데이터 API의 명세가 변경되더라도 내부 비즈니스 로직의 수정을 최소화할 수 있는 유연한 아키텍처를 구축했습니다.

## 향후 개선 계획
- Redis 캐싱 도입: 빈번하게 조회되는 진료 항목 및 지역 데이터의 응답 속도 개선
- CI/CD 파이프라인 구축: GitHub Actions를 활용한 자동 빌드 및 배포 자동화
